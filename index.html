<!-- Blake Thompson - Senior Project -->
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <!-- TESTING: INITIALIZING MAP -->
    <style> #map {
      height: 480px;
      width: 100%;
    }
      .button{
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
      }

    .button1 {background-color: #2094f3;} 

    .button1:hover {
      background-color: #2094f3;
      color: blue;
    }
    </style>
    
      
<!-- ------------------------------------------------------- -->
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
    <!-- BROWSER TAB LOGO AND TITLE -->
      <link rel="shortcut icon" href="assets/images/DownHILL.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.4">

      <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
        <title>DownHILL</title>
      
      <link rel="stylesheet" href="assets/stylesheets/main.77f3fd56.min.css">
            
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
            
          <meta name="theme-color" content="#2094f3">
          
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
  
  </head>
   
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">

    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        <a href="#pattern-book" class="md-skip">
          Skip to content
        </a>
      
    </div>

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <!-- NEEDS LINK TO BRING TO MOBILE VIEWBOX MENU -->
    <!-- <a href=".">Menu</a> -->
    <a href="." title="DownHILL" class="md-header__button md-logo" aria-label="DownHILL">
      <!-- LOGO FOR BANNER -->
      <img src="assets/images/DownHILL.png" alt="DownHILL" width="50" height="50">
    </a>
    
    <label class="md-header__button md-icon" for="__drawer">

      <img src="assets/images/DownHILL.png" alt="DownHILL" width="50" height="50">
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <!-- TITLE OF BANNER -->
          <span class="md-ellipsis">
            DownHILL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          
          <span class="md-ellipsis">
              Header Topic          
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
       <img src="assets/images/DownHILL.png" alt="DownHILL" width="50" height="50">
      </label>
        
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
            
<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
   
    <a href="." title="Senior Project" class="md-nav__button md-logo" aria-label="Senior Project">
      <!-- MENU LOGO FOR MOBILE -->
      <img src="assets/images/DownHILL.png" alt="DownHILL" width="50" height="50">
      <!-- MENU TITLE FOR DESKTOP-->
    </a>
    <u>DownHILL - Senior Project</u>
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
 
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">

      <!-- MENU TITLE FOR MOBILE -->
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        Home
      </a>

    </li>

    <li class="md-nav__item">
      <a href="Code/" class="md-nav__link">
        Code
      </a>
    </li>
  
  </ul>
</nav>
                  </div>
                </div>
              </div>
     
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1>Google Maps API Web App</h1>
                <p>This project is designed to create a custom map route that will find the most <u>consistant downhill</u> route, avoiding as much uphill travel as possible. Custom routes are decided by inputting the desired starting and ending addresses within the given range. The idea is to calculate a route that will provide the best cruising experience while getting the user to the requested destination.</p>
                <p>APIs Used: Google - Maps JavaScript, Maps Elevation, and Geocoding</p>
                <h2 id="pattern-layout">Enter Data:</h2>
                <p>You can either manually type address in the format: <b><q>123 N Something St</q>.</b></p>
                <p><b>OR</b></p> 
                <p>You can click the position on the map, copy the coordinates in the pop up window, and then paste them.</p>
  
                <!-- Creates text and then an input for text -->
                  <label for="start">Starting Address:</label>
                  <input type="text" id="start" name="startTxt" size="20" style="color: black" placeholder="&quot;123 N 3rd St&quot;"/>
                  <label for="start2" style="margin-left:64px;">Starting Location:</label>
                  <input type="text" id="start2" name="start2Txt" size="20" style="color: black" placeholder="&quot;Lat: Lng:&quot;"/>
                  <div></div>
                  <label for="end">Ending Address:&nbsp;&nbsp;</label>
                  <input type="text" id="end" name="endTxt" size="20" style="color: black" placeholder="&quot;321 N 4th St&quot;"/>
                  <label for="end2" style="margin-left:64px;">Ending Location:&nbsp;&nbsp;</label>
                  <input type="text" id="end2" name="end2Txt" size="20" style="color: black" placeholder="&quot;Lat: Lng:&quot;"/>
                 
                  <div></div>
                  <button class="button button1" id="enter">Enter Address</button>
                  <button class="button button1" id="enter2" style="margin-left:178px;">Enter Location</button>

                  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
              
                  <!-- testing js code -->
                  <script> 
                    document.getElementById("enter").addEventListener("click", grabAddress);
                    document.getElementById("enter2").addEventListener("click", geocodeCoord);

                    //Creates the Geocoder
                    function geocodeCoord(){
                      var latStrt;
                      var lngStrt;
                      var latEnd;
                      var lngEnd;
                      var start = document.getElementById("start2").value;
                      var end = document.getElementById("end2").value;
                      var startAddy;
                      var endAddy;
                      var startOutput
                      var endOutput;

                      //START INPUT
                      if(start.charAt(0) == '{' || start.charAt(0) == '4'){
                        const latlngStrt = start.split(",",2);
                        if(latlngStrt[0].substring(0,1) == "4")latStrt = latlngStrt[0];
                        else latStrt = latlngStrt[0].substring(8);
                        if(latlngStrt[1].substring(0,2) == "-8") lngStrt = latlngStrt[1];
                        else lngStrt = latlngStrt[1].substring(7,latlngStrt[1].length-1);
                        const latlngS = latStrt + "," + lngStrt;
                        //alert(latlngS);
                        //getGeocode(startCoord);    https://maps.googleapis.com/maps/api/geocode/json?latlng=40.714224,-73.961452&key=YOUR_API_KEY
                        axios.get('https:maps.googleapis.com/maps/api/geocode/json',{
                          params:{
                            latlng: latlngS,
                            key:'AIzaSyDXv29cjGoYgAy0VD5MVexGcdlXwd0eohg'
                          }
                        })
                        .then(function(response){
                          //console.log(response);
                          //formatted address
                          //startAddy = response.data.results[0].address_components[0].short_name + " " + response.data.results[0].address_components[1].short_name;       
                          startAddy = response.data.results[0].address_components[0];
                          console.log(startAddy);
                          startOutput = `
                            <ul>
                              <li>${startAddy}</li>
                            </ul>
                          `;
                          document.getElementById('test').innerHTML = startOutput;
                          //startAddy = response.data.results[0].address_components[0].short_name + " " + response.data.results[0].address_components[1].short_name;
                          //alert(response.data.results[0].address_components[0].short_name + " " + response.data.results[0].address_components[1].short_name);
                          //document.getElementById('test').innerHTML = startAddy;
                          //startOutput = JSON.stringify(startAddy)
                        })
                        .catch(function(error){
                          console.log(error);
                        });
                      }
                        
                      //END INPUT
                      if(end.charAt(0) == '{' || end.charAt(0) == '4'){
                        const latlngEnd = end.split(",",2);
                        if(latlngEnd[0].substring(0,1) == "4")latEnd = latlngEnd[0];
                        else latEnd = latlngEnd[0].substring(8);
                        if(latlngEnd[1].substring(0,2) == "-8") lngEnd = latlngEnd[1];
                        else lngEnd = latlngEnd[1].substring(7,latlngEnd[1].length-1);
                        const latlngE = latEnd + "," + lngEnd;
                        axios.get('https:maps.googleapis.com/maps/api/geocode/json',{
                          params:{
                            latlng: latlngE,
                            key:'AIzaSyDXv29cjGoYgAy0VD5MVexGcdlXwd0eohg'
                          }
                        })
                        .then(function(response){
                          //console.log(response);
                          //formatted address
                          endAddy = response.data.results[0].address_components[0].short_name + " " + response.data.results[0].address_components[1].short_name;
                          //alert(response.data.results[0].address_components[0].short_name + " " + response.data.results[0].address_components[1].short_name);
                          console.log(response.data.results[0].address_components[0].short_name + " " + response.data.results[0].address_components[1].short_name);                    
                        })
                        .catch(function(error){
                          console.log(error);
                        });
                      }
                      //var route = startOutput + endOutput;
                      //document.getElementById('test').innerHTML = startOutput;
                    }
                    /*function getGeocode(coord){
                      //START GEOCODE
                      const geocoder = new google.maps.Geocoder();
                      geocoder.geocode({ location: coord})
                      .then((respoonse) => {
                        if(response.results[0]){
                          document.getElementById("test").innerHTML = response.results[0].formatted_address;
                          //document.getElementById("test").innerHTML = "TESTING CONVERTCOORD()";
                        }
                        else alert("No results found");
                      })
                      .catch((e) => window.alert("Geocoder failed due to: " + e));
                    }  */
                    
                    //Grabs addresses from input text
                    function grabAddress(){

                      var start = document.getElementById("start").value;
                      var end = document.getElementById("end").value;
                        
                        //Searches for valid street
                        var findS = searchAddress(start);
                        var findE = searchAddress(end);
                        //NEED TO CONVERT INTERSECTIONS[] ID TO FULL BLOCK ST NAME
                      
                        if(findS === undefined && findE === undefined)alert("Starting and Ending locations are not found or within range.");
                        else if(findS == undefined)alert("Starting location is not found or within range");
                        else if(findE == undefined)alert("Ending location is not found or within range");
                        else alert(findS + ' ' + findE);
              
                      
                      //alert(start + ' ' + end);
                    }
                  </script>
            
              <!-- ADDS JAVASCRIPT FILE TO INDEX.HTML -->
              <!-- CREATES MAP AND ADDRESS INPUT PLUS BUTTONS -->
              <script type="module" src="map.js"> </script>

              <div id="map" style="width:100%;height:400px;"></div>

              <!-- TESTING DHMAP ADDRESS ARRAY -->
              <p id="test"></p>
              <script src="DHMap.js"> </script>
 
            </article>
          </div>
        </div>
      </main>
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.9b151c6a.min.js"></script>
     <!-- ADDS GOOGLE API WITH API KEY -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDXv29cjGoYgAy0VD5MVexGcdlXwd0eohg&callback=myMap" defer > </script>
    <script src="https://maps.googleapis.com/maps/api/geocode/json?place_id=ChIJeRpOeF67j4AR9ydy_PIzPuM&key=AIzaSyDXv29cjGoYgAy0VD5MVexGcdlXwd0eohg&callback=myMap" defer > </script>
    
  </body>
</html>
